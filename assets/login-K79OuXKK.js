import{R as y,ad as A,ae as $,S as T,Y as P,$ as R,X as l,L as o,aw as m,ai as p,Z as s,aN as q,au as g,af as B,ag as F,am as N}from"./index-CazOE4wl.js";import{c as C,a as f,u as L,e as V,V as M}from"./index.esm-DZkYhu6i.js";import{v as U}from"./index-DSMqsl_x.js";import{b}from"./route-block-B_A1xBdJ.js";import{V as v,a as D}from"./VRow-DYi6lY_M.js";import{V as I}from"./VDivider-DgMmXQ-N.js";import{V as E}from"./VContainer-DhHz2rcs.js";const X={class:"text-center"},Y={class:"text-center"},Z={__name:"login",setup(j){const{t:e}=y(),{api:w}=N(),c=A(),h=$(),S=T(),x=C({account:f().required(e("api.userAccountRequired")).min(4,e("api.userAccountTooShort")).max(20,e("api.userAccountTooLong")).test("isAlphanumeric",e("api.userAccountInvalid"),a=>U.isAlphanumeric(a)),password:f().required(e("api.userPasswordRequired")).min(4,e("api.userPasswordTooShort")).max(20,e("api.userPasswordTooLong"))}),{handleSubmit:_,isSubmitting:d}=L({validationSchema:x}),u=V("account"),i=V("password"),k=_(async a=>{var r,t;try{const{data:n}=await w.post("/user/login",{account:a.account,password:a.password});S.login(n.result),c({text:e("login.success"),snackbarProps:{color:"green"}}),h.push("/")}catch(n){console.log(n),c({text:e("api."+(((t=(r=n==null?void 0:n.response)==null?void 0:r.data)==null?void 0:t.message)||"unknownError")),snackbarProps:{color:"red"}})}});return(a,r)=>(P(),R(E,null,{default:l(()=>[o(D,null,{default:l(()=>[o(v,{cols:"12"},{default:l(()=>[m("h1",X,p(a.$t("nav.login")),1)]),_:1}),o(I),o(v,{cols:"12"},{default:l(()=>[o(M,{disabled:s(d),onSubmit:q(s(k),["prevent"])},{default:l(()=>[o(g,{modelValue:s(u).value.value,"onUpdate:modelValue":r[0]||(r[0]=t=>s(u).value.value=t),"error-messages":s(u).errorMessage.value,label:a.$t("user.account"),minlength:"4",maxlength:"20",counter:""},null,8,["modelValue","error-messages","label"]),o(g,{modelValue:s(i).value.value,"onUpdate:modelValue":r[1]||(r[1]=t=>s(i).value.value=t),type:"password","error-messages":s(i).errorMessage.value,label:a.$t("user.password"),minlength:"4",maxlength:"20",counter:""},null,8,["modelValue","error-messages","label"]),m("div",Y,[o(B,{loading:s(d),type:"submit",color:"primary"},{default:l(()=>[F(p(a.$t("login.submit")),1)]),_:1},8,["loading"])])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}))}};typeof b=="function"&&b(Z);export{Z as default};
